<Window
    x:Class="Pipboy.Wallpaper.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:Pipboy.Wallpaper.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Pipboy.Wallpaper"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Name="Root"
    Title="Pip-Boy Wallpaper"
    Background="{DynamicResource WallpaperBackgroundBrush}"
    mc:Ignorable="d">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    </Window.Resources>
    <Grid x:Name="MainBorder">
        <!--<Grid.Background>
            <ImageBrush ImageSource="/testbg.jpg" Stretch="UniformToFill"/>
        </Grid.Background>-->
        <controls:CrtDisplay
        x:Name="MyCrtDisplay"
        DataContext="{Binding EffectDataContext}"
        EnableFlicker="True"
        EnableNoise="{Binding EnableNoise}"
        EnableScanBeamBlur="{Binding EnableScanBeamBlur}"
        EnableScanlineAnimation="{Binding EnableScanlineAnimation}"
        FlickerIntensity="1"
        NoiseDensity="{Binding NoiseDensity}"
        NoiseOpacity="{Binding NoiseOpacity}"
        NoisePixelSize="{Binding NoisePixelSize}"
        NoiseRefreshRate="{Binding NoiseRefreshRate}"
        ScanBeamColor="{Binding ScanBeamColor}"
        ScanBeamHeight="{Binding ScanBeamHeight}"
        ScanlineAnimSpeed="{Binding ScanlineAnimSpeed}"
        ScanlineColor="{Binding ScanlineColor}"
        ScanlineHeight="{Binding ScanlineHeight}"
        ScanlineSpacing="{Binding ScanlineSpacing}"
        ShowFps="True"
        UseCachedRendering="{Binding UseCachedRendering}">

            <Grid DataContext="{Binding ElementName=Root, Path=DataContext}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="100" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <TextBlock
                Grid.Row="0"
                Margin="20"
                HorizontalAlignment="Center"
                VerticalAlignment="Top"
                FontSize="32"
                Foreground="{DynamicResource PipboyTextColor}">
                    <TextBlock.Text>
                        <Binding Path="TextDataContext.Title" />
                    </TextBlock.Text>
                    <TextBlock.Effect>
                        <DropShadowEffect
                        BlurRadius="5"
                        Direction="0"
                        Opacity="0.6"
                        ShadowDepth="0"
                        Color="{DynamicResource PipboyGreenColor}" />
                    </TextBlock.Effect>
                </TextBlock>

                <TextBlock
                Grid.Row="1"
                MaxWidth="700"
                Margin="20"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                FontSize="{Binding TextDataContext.ContentFontSize}"
                Foreground="{DynamicResource PipboyTextColor}"
                Text="{Binding TextDataContext.Content}"
                TextWrapping="Wrap" />

                <StackPanel
                Grid.Row="2"
                Margin="0,0,0,10"
                HorizontalAlignment="Center"
                VerticalAlignment="Bottom">

                    <TextBlock
                    x:Name="CurrentDateTimeTextBlock"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="{DynamicResource PipboyTextColor}"
                    Text="{Binding TextDataContext.CurrentDateTimeString}"
                    Visibility="{Binding TextDataContext.ShowDatetime, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <TextBlock.Effect>
                            <DropShadowEffect
                            BlurRadius="5"
                            Direction="0"
                            Opacity="0.6"
                            ShadowDepth="0"
                            Color="{DynamicResource PipboyGreenColor}" />
                        </TextBlock.Effect>
                    </TextBlock>

                    <TextBlock
                    Margin="0,5,0,0"
                    FontSize="11"
                    FontWeight="Bold"
                    Foreground="{DynamicResource PipboyTextColor}"
                    Text="{Binding TextDataContext.Version}" />
                </StackPanel>

                <Border Grid.Row="3" Height="{Binding TaskbarHeight, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            </Grid>
        </controls:CrtDisplay>
        <TextBlock Foreground="Red"  FontSize="50"  Text="haha" VerticalAlignment="Center" HorizontalAlignment="Center"/>
    </Grid>
</Window>